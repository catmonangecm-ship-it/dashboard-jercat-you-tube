<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Tableau de Bord YouTube Pro - Automatique</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
        body { font-family: 'Inter', sans-serif; }
        
        /* Dark Mode */
        body.dark-mode { background: linear-gradient(to bottom right, #0f172a, #1e293b); color: #e2e8f0; }
        body.dark-mode .bg-white { background-color: #1e293b !important; }
        body.dark-mode .bg-gray-50 { background-color: #0f172a !important; }
        body.dark-mode .bg-gray-100 { background-color: #334155 !important; }
        body.dark-mode .text-gray-900 { color: #f1f5f9 !important; }
        body.dark-mode .text-gray-700 { color: #cbd5e1 !important; }
        body.dark-mode .text-gray-600 { color: #94a3b8 !important; }
        body.dark-mode .text-gray-500 { color: #64748b !important; }
        body.dark-mode .border-gray-200 { border-color: #334155 !important; }
        body.dark-mode .shadow { box-shadow: 0 4px 6px rgba(0, 0, 0, 0.3) !important; }
        
        .stat-card { transition: all 0.3s ease; }
        .stat-card:hover { transform: translateY(-5px); box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1); }
        .progress-bar { transition: width 0.5s ease; }
        .metric-badge { animation: pulse 2s infinite; }
        @keyframes pulse { 0%, 100% { opacity: 1; } 50% { opacity: 0.8; } }
        
        .chart-container { position: relative; height: 300px; }
        
        .loading-spinner {
            border: 3px solid #f3f4f6;
            border-top: 3px solid #3b82f6;
            border-radius: 50%;
            width: 40px;
            height: 40px;
            animation: spin 1s linear infinite;
        }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
        
        .status-dot {
            width: 8px;
            height: 8px;
            border-radius: 50%;
            display: inline-block;
            margin-right: 8px;
        }
        .status-connected { background-color: #10b981; animation: pulse 2s infinite; }
        .status-disconnected { background-color: #ef4444; }
        .status-loading { background-color: #f59e0b; animation: pulse 1s infinite; }

        .modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.7);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        .modal.active { display: flex; }

        .goal-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 12px;
            padding: 20px;
            color: white;
            transition: transform 0.3s ease;
        }
        .goal-card:hover { transform: scale(1.02); }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            background: linear-gradient(135deg, #10b981, #059669);
            color: white;
            padding: 16px 24px;
            border-radius: 12px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.3);
            z-index: 2000;
            animation: slideIn 0.5s ease;
        }
        @keyframes slideIn {
            from { transform: translateX(400px); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }

        .gradient-text {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            background-clip: text;
        }

        .revenue-section {
            background: linear-gradient(135deg, #fbbf24 0%, #f59e0b 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
        }

        .monetization-section {
            background: linear-gradient(135deg, #10b981 0%, #059669 100%);
            border-radius: 16px;
            padding: 24px;
            color: white;
        }
    </style>
</head>
<body class="bg-gray-50">
    
    <!-- Modal de configuration -->
    <div id="setupModal" class="modal active">
        <div class="bg-white rounded-2xl p-8 max-w-2xl w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">üîß Configuration API YouTube</h2>
            <p class="text-gray-600 mb-6">Pour activer la synchronisation automatique, vous devez configurer l'acc√®s √† l'API YouTube.</p>
            
            <div class="space-y-4 mb-6">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Cl√© API YouTube Data v3</label>
                    <input type="text" id="apiKeyInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="AIzaSy...">
                    <p class="text-xs text-gray-500 mt-1">
                        <a href="https://console.cloud.google.com/apis/credentials" target="_blank" class="text-blue-600 hover:underline">
                            Obtenir une cl√© API Google
                        </a>
                    </p>
                </div>
                
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">ID de votre cha√Æne YouTube</label>
                    <input type="text" id="channelIdInput" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500" placeholder="UC...">
                    <p class="text-xs text-gray-500 mt-1">
                        Trouvez votre ID : YouTube Studio ‚Üí Param√®tres ‚Üí Cha√Æne ‚Üí Informations avanc√©es
                    </p>
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Fr√©quence de synchronisation</label>
                    <select id="syncFrequency" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500">
                        <option value="300000">Toutes les 5 minutes</option>
                        <option value="600000">Toutes les 10 minutes</option>
                        <option value="1800000">Toutes les 30 minutes</option>
                        <option value="3600000">Toutes les heures</option>
                    </select>
                </div>
            </div>

            <div class="bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6">
                <h3 class="text-sm font-bold text-blue-900 mb-2">üìö Guide rapide :</h3>
                <ol class="text-xs text-blue-800 space-y-1 ml-4 list-decimal">
                    <li>Allez sur <a href="https://console.cloud.google.com/" target="_blank" class="underline">Google Cloud Console</a></li>
                    <li>Cr√©ez un nouveau projet (ou s√©lectionnez-en un)</li>
                    <li>Activez "YouTube Data API v3"</li>
                    <li>Cr√©ez des identifiants ‚Üí Cl√© API</li>
                    <li>Copiez la cl√© et collez-la ci-dessus</li>
                    <li>Trouvez votre ID de cha√Æne dans YouTube Studio</li>
                </ol>
            </div>

            <div class="flex gap-3">
                <button onclick="saveConfig()" class="flex-1 bg-blue-600 hover:bg-blue-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                    üíæ Sauvegarder et connecter
                </button>
                <button onclick="useManualMode()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg transition-colors">
                    Mode manuel
                </button>
            </div>
        </div>
    </div>

    <!-- Modal Nouvel Objectif -->
    <div id="goalModal" class="modal">
        <div class="bg-white rounded-2xl p-8 max-w-md w-full mx-4 shadow-2xl">
            <h2 class="text-2xl font-bold text-gray-900 mb-4">üéØ Nouvel Objectif</h2>
            
            <div class="space-y-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Type d'objectif</label>
                    <select id="goalType" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                        <option value="subscribers">üë• Abonn√©s</option>
                        <option value="views">üëÅÔ∏è Vues totales</option>
                        <option value="videos">üé¨ Vid√©os publi√©es</option>
                        <option value="revenue">üí∞ Revenus estim√©s ($)</option>
                        <option value="watchTime">‚è±Ô∏è Heures de visionnage</option>
                    </select>
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Objectif √† atteindre</label>
                    <input type="number" id="goalTarget" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500" placeholder="Ex: 1000">
                </div>

                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Date limite (optionnel)</label>
                    <input type="date" id="goalDeadline" class="w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500">
                </div>
            </div>

            <div class="flex gap-3 mt-6">
                <button onclick="addGoal()" class="flex-1 bg-purple-600 hover:bg-purple-700 text-white font-bold py-3 px-6 rounded-lg transition-colors">
                    ‚ú® Cr√©er l'objectif
                </button>
                <button onclick="closeGoalModal()" class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-semibold py-3 px-6 rounded-lg transition-colors">
                    Annuler
                </button>
            </div>
        </div>
    </div>

    <!-- Header -->
    <header class="bg-white shadow-sm sticky top-0 z-50">
        <div class="max-w-7xl mx-auto px-4 py-4 flex items-center justify-between">
            <div class="flex items-center gap-3">
                <div class="w-12 h-12 bg-red-600 rounded-xl flex items-center justify-center">
                    <svg class="w-7 h-7 text-white" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M23.498 6.186a3.016 3.016 0 0 0-2.122-2.136C19.505 3.545 12 3.545 12 3.545s-7.505 0-9.377.505A3.017 3.017 0 0 0 .502 6.186C0 8.07 0 12 0 12s0 3.93.502 5.814a3.016 3.016 0 0 0 2.122 2.136c1.871.505 9.376.505 9.376.505s7.505 0 9.377-.505a3.015 3.015 0 0 0 2.122-2.136C24 15.93 24 12 24 12s0-3.93-.502-5.814zM9.545 15.568V8.432L15.818 12l-6.273 3.568z"/>
                    </svg>
                </div>
                <div>
                    <h1 class="text-xl font-bold text-gray-900">Tableau de Bord YouTube Pro</h1>
                    <div class="flex items-center text-xs">
                        <span id="connectionStatus" class="status-dot status-disconnected"></span>
                        <span id="connectionText" class="text-gray-500">Non connect√©</span>
                    </div>
                </div>
            </div>
            <div class="flex items-center gap-3">
                <button onclick="manualSync()" id="syncBtn" class="bg-blue-600 hover:bg-blue-700 text-white px-4 py-2 rounded-lg font-semibold text-sm transition-colors flex items-center gap-2">
                    <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15"/>
                    </svg>
                    Sync
                </button>
                <button onclick="openSettings()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold text-sm transition-colors">
                    ‚öôÔ∏è
                </button>
                <button onclick="toggleDarkMode()" class="bg-gray-100 hover:bg-gray-200 text-gray-700 px-4 py-2 rounded-lg font-semibold text-sm transition-colors">
                    üåô
                </button>
            </div>
        </div>
    </header>

    <div class="max-w-7xl mx-auto px-4 py-8">
        
        <!-- Date et mise √† jour -->
        <div class="flex items-center justify-between mb-8">
            <div>
                <h2 class="text-2xl font-bold text-gray-900">Vue d'ensemble</h2>
                <p class="text-sm text-gray-500">
                    Derni√®re sync : <span id="lastSync">Jamais</span>
                    <span class="ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded">
                        Auto-sync : <span id="autoSyncStatus">OFF</span>
                    </span>
                </p>
            </div>
            <div id="loadingIndicator" class="loading-spinner" style="display: none;"></div>
        </div>

        <!-- KPIs Principaux -->
        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8">
            
            <!-- Abonn√©s -->
            <div class="stat-card bg-white rounded-xl p-6 shadow">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-red-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-red-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M9 6a3 3 0 11-6 0 3 3 0 016 0zM17 6a3 3 0 11-6 0 3 3 0 016 0zM12.93 17c.046-.327.07-.66.07-1a6.97 6.97 0 00-1.5-4.33A5 5 0 0119 16v1h-6.07zM6 11a5 5 0 015 5v1H1v-1a5 5 0 015-5z"/>
                        </svg>
                    </div>
                    <span class="text-xs font-semibold text-green-600 bg-green-100 px-2 py-1 rounded">
                        +<span id="subsGrowth">0</span>
                    </span>
                </div>
                <div class="text-3xl font-bold text-gray-900 mb-1" id="subscribers">0</div>
                <div class="text-sm text-gray-600">Abonn√©s</div>
                <div class="mt-4 text-xs text-gray-500">
                    Objectif: <span id="subsObjective">1000</span> | Reste: <span id="subsRemaining">1000</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div id="subsProgress" class="progress-bar bg-red-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <!-- Vues totales -->
            <div class="stat-card bg-white rounded-xl p-6 shadow">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-blue-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M10 12a2 2 0 100-4 2 2 0 000 4z"/>
                            <path fill-rule="evenodd" d="M.458 10C1.732 5.943 5.522 3 10 3s8.268 2.943 9.542 7c-1.274 4.057-5.064 7-9.542 7S1.732 14.057.458 10zM14 10a4 4 0 11-8 0 4 4 0 018 0z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <span class="text-xs font-semibold text-green-600 bg-green-100 px-2 py-1 rounded">
                        +<span id="viewsGrowth">0</span>
                    </span>
                </div>
                <div class="text-3xl font-bold text-gray-900 mb-1" id="views">0</div>
                <div class="text-sm text-gray-600">Vues totales</div>
                <div class="mt-4 text-xs text-gray-500">
                    Objectif: <span id="viewsObjective">10000</span>
                </div>
                <div class="w-full bg-gray-200 rounded-full h-2 mt-2">
                    <div id="viewsProgress" class="progress-bar bg-blue-600 h-2 rounded-full" style="width: 0%"></div>
                </div>
            </div>

            <!-- Vid√©os publi√©es -->
            <div class="stat-card bg-white rounded-xl p-6 shadow">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-purple-600" fill="currentColor" viewBox="0 0 20 20">
                            <path d="M2 6a2 2 0 012-2h6a2 2 0 012 2v8a2 2 0 01-2 2H4a2 2 0 01-2-2V6zM14.553 7.106A1 1 0 0014 8v4a1 1 0 00.553.894l2 1A1 1 0 0018 13V7a1 1 0 00-1.447-.894l-2 1z"/>
                        </svg>
                    </div>
                    <span class="text-xs font-semibold text-blue-600 bg-blue-100 px-2 py-1 rounded">
                        +<span id="videosNew">0</span> cette semaine
                    </span>
                </div>
                <div class="text-3xl font-bold text-gray-900 mb-1" id="videos">0</div>
                <div class="text-sm text-gray-600">Vid√©os publi√©es</div>
                <div class="mt-4 text-xs text-gray-500">
                    Derni√®re upload: <span id="lastUpload">N/A</span>
                </div>
            </div>

            <!-- Commentaires -->
            <div class="stat-card bg-white rounded-xl p-6 shadow">
                <div class="flex items-center justify-between mb-4">
                    <div class="w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center">
                        <svg class="w-6 h-6 text-green-600" fill="currentColor" viewBox="0 0 20 20">
                            <path fill-rule="evenodd" d="M18 10c0 3.866-3.582 7-8 7a8.841 8.841 0 01-4.083-.98L2 17l1.338-3.123C2.493 12.767 2 11.434 2 10c0-3.866 3.582-7 8-7s8 3.134 8 7zM7 9H5v2h2V9zm8 0h-2v2h2V9zM9 9h2v2H9V9z" clip-rule="evenodd"/>
                        </svg>
                    </div>
                    <span class="text-xs font-semibold text-purple-600 bg-purple-100 px-2 py-1 rounded">
                        Engagement: <span id="engagementRate">0</span>%
                    </span>
                </div>
                <div class="text-3xl font-bold text-gray-900 mb-1" id="comments">0</div>
                <div class="text-sm text-gray-600">Commentaires</div>
                <div class="mt-4 text-xs text-gray-500">
                    Likes: <span id="likes">0</span>
                </div>
            </div>
        </div>

        <!-- üí∞ CALCULATEUR DE REVENUS -->
        <div class="revenue-section mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold">üí∞ Estimation des Revenus</h3>
                <div class="bg-white bg-opacity-20 rounded-lg px-4 py-2">
                    <div class="text-xs opacity-90">Vues mon√©tis√©es</div>
                    <div class="text-lg font-bold" id="monetizedViews">0</div>
                </div>
            </div>

            <div class="grid grid-cols-1 lg:grid-cols-3 gap-6">
                <!-- Slider CPM -->
                <div class="bg-white bg-opacity-10 rounded-xl p-6">
                    <label class="block text-sm font-semibold mb-3">CPM estim√© (USD)</label>
                    <input type="range" id="cpmSlider" min="0.5" max="10" step="0.1" value="2" 
                           class="w-full h-3 bg-white bg-opacity-20 rounded-lg appearance-none cursor-pointer"
                           oninput="updateRevenueEstimate()">
                    <div class="flex justify-between text-sm mt-2 opacity-90">
                        <span>$0.50</span>
                        <span class="font-bold text-lg" id="cpmValue">$2.00</span>
                        <span>$10.00</span>
                    </div>
                    <div class="text-xs mt-3 opacity-75">
                        üí° CPM = Co√ªt pour 1000 vues<br>
                        Moyenne YouTube : $1-4
                    </div>
                </div>

                <!-- Revenus mensuels -->
                <div class="bg-white bg-opacity-10 rounded-xl p-6 text-center">
                    <div class="text-sm opacity-90 mb-2">üìÖ Revenus mensuels estim√©s</div>
                    <div class="text-4xl font-bold mb-2" id="monthlyRevenue">$0.00</div>
                    <div class="text-xs opacity-75">
                        Bas√© sur <span id="monthlyViews">0</span> vues/mois
                    </div>
                    <div class="mt-4 text-sm bg-white bg-opacity-10 rounded-lg px-3 py-2">
                        Revenue/vue : <span id="revenuePerView">$0.00</span>
                    </div>
                </div>

                <!-- Revenus annuels -->
                <div class="bg-white bg-opacity-10 rounded-xl p-6 text-center">
                    <div class="text-sm opacity-90 mb-2">üìä Revenus annuels estim√©s</div>
                    <div class="text-4xl font-bold mb-2" id="yearlyRevenue">$0.00</div>
                    <div class="text-xs opacity-75">
                        Projection sur 12 mois
                    </div>
                    <div class="mt-4 text-sm bg-white bg-opacity-10 rounded-lg px-3 py-2">
                        Objectif 1K$/mois dans <span id="daysTo1K">--</span> jours
                    </div>
                </div>
            </div>

            <div class="mt-4 text-xs opacity-75 bg-white bg-opacity-10 rounded-lg p-3">
                ‚ö†Ô∏è <strong>Estimations bas√©es sur</strong> : ~55% de vues mon√©tis√©es (apr√®s AdBlock, r√©gions non-mon√©tisables, etc.).
                Les revenus r√©els varient selon la g√©olocalisation, le contenu, la saison et l'engagement.
            </div>
        </div>

        <!-- üìä TRACKER DE MON√âTISATION -->
        <div class="monetization-section mb-8">
            <h3 class="text-2xl font-bold mb-6">üìä Tracker du Programme Partenaire YouTube</h3>
            
            <div id="monetizationStatus" class="bg-white bg-opacity-10 rounded-xl p-6 mb-6">
                <div class="text-center mb-6">
                    <div class="text-6xl mb-3">üéØ</div>
                    <div class="text-xl font-bold" id="eligibilityMessage">En progression vers la mon√©tisation</div>
                    <div class="text-sm opacity-90 mt-2" id="eligibilityDetails">Continuez vos efforts !</div>
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                <!-- Abonn√©s -->
                <div class="bg-white bg-opacity-10 rounded-xl p-6">
                    <div class="flex items-center justify-between mb-3">
                        <div class="text-lg font-bold">üë• Abonn√©s</div>
                        <div class="text-sm opacity-90">
                            <span id="currentSubs">0</span> / 1,000
                        </div>
                    </div>
                    <div class="w-full bg-white bg-opacity-20 rounded-full h-4 mb-2">
                        <div id="subsMonetProgress" class="bg-white h-4 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                    <div class="text-sm opacity-90">
                        Encore <span id="subsMonetRemaining">1,000</span> abonn√©s
                    </div>
                </div>

                <!-- Heures de visionnage -->
                <div class="bg-white bg-opacity-10 rounded-xl p-6">
                    <div class="flex items-center justify-between mb-3">
                        <div class="text-lg font-bold">‚è±Ô∏è Heures de visionnage</div>
                        <div class="text-sm opacity-90">
                            <span id="currentWatchHours">0</span> / 4,000h
                        </div>
                    </div>
                    <div class="w-full bg-white bg-opacity-20 rounded-full h-4 mb-2">
                        <div id="watchHoursProgress" class="bg-white h-4 rounded-full transition-all" style="width: 0%"></div>
                    </div>
                    <div class="text-sm opacity-90">
                        Encore <span id="watchHoursRemaining">4,000</span> heures (sur 12 mois)
                    </div>
                </div>
            </div>

            <div class="mt-4 text-xs opacity-75 bg-white bg-opacity-10 rounded-lg p-3">
                ‚ÑπÔ∏è <strong>Crit√®res de mon√©tisation</strong> : 1,000 abonn√©s + 4,000 heures de visionnage (12 derniers mois) + Respect des r√®gles YouTube
            </div>
        </div>

        <!-- üéØ OBJECTIFS PERSONNALIS√âS -->
        <div class="bg-white rounded-xl p-6 shadow mb-8">
            <div class="flex items-center justify-between mb-6">
                <h3 class="text-2xl font-bold text-gray-900">üéØ Mes Objectifs</h3>
                <button onclick="openGoalModal()" class="bg-purple-600 hover:bg-purple-700 text-white px-4 py-2 rounded-lg font-semibold text-sm transition-colors">
                    ‚ûï Nouvel objectif
                </button>
            </div>

            <div id="goalsContainer" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="text-center text-gray-500 py-8 col-span-full">
                    Aucun objectif d√©fini. Cr√©ez-en un pour commencer ! üöÄ
                </div>
            </div>
        </div>

        <!-- Derni√®res vid√©os -->
        <div class="bg-white rounded-xl p-6 shadow mb-8">
            <h3 class="text-lg font-bold text-gray-900 mb-4">üé¨ Derni√®res vid√©os</h3>
            <div id="recentVideos" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div class="text-center text-gray-500 py-8">Aucune vid√©o charg√©e</div>
            </div>
        </div>

        <!-- Graphiques -->
        <div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
            
            <!-- √âvolution des vues -->
            <div class="bg-white rounded-xl p-6 shadow">
                <h3 class="text-lg font-bold text-gray-900 mb-4">√âvolution des vues (7 derniers jours)</h3>
                <div class="chart-container">
                    <canvas id="viewsChart"></canvas>
                </div>
            </div>

            <!-- Top Vid√©os -->
            <div class="bg-white rounded-xl p-6 shadow">
                <h3 class="text-lg font-bold text-gray-900 mb-4">Top 5 Vid√©os (vues)</h3>
                <div class="chart-container">
                    <canvas id="topVideosChart"></canvas>
                </div>
            </div>
        </div>

        <!-- Statistiques d√©taill√©es -->
        <div class="bg-white rounded-xl p-6 shadow">
            <h3 class="text-lg font-bold text-gray-900 mb-4">üìä Statistiques d√©taill√©es</h3>
            <div class="grid grid-cols-2 md:grid-cols-4 gap-6">
                <div class="text-center">
                    <div class="text-2xl font-bold text-blue-600" id="avgViews">0</div>
                    <div class="text-xs text-gray-600 mt-1">Vues moyennes/vid√©o</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-purple-600" id="avgLikes">0</div>
                    <div class="text-xs text-gray-600 mt-1">Likes moyens/vid√©o</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-green-600" id="avgComments">0</div>
                    <div class="text-xs text-gray-600 mt-1">Commentaires moyens</div>
                </div>
                <div class="text-center">
                    <div class="text-2xl font-bold text-red-600" id="totalDuration">0h</div>
                    <div class="text-xs text-gray-600 mt-1">Dur√©e totale contenu</div>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Configuration
        let config = {
            apiKey: '',
            channelId: '',
            syncFrequency: 300000,
            manualMode: false
        };

        let syncInterval = null;
        let charts = {};
        let channelData = {};
        let goals = [];

        // ========== CONFIGURATION ==========

        function loadConfig() {
            const saved = localStorage.getItem('youtubeConfig');
            if (saved) {
                config = JSON.parse(saved);
                if (config.apiKey && config.channelId && !config.manualMode) {
                    document.getElementById('setupModal').classList.remove('active');
                    startAutoSync();
                    return true;
                }
            }
            return false;
        }

        function saveConfig() {
            const apiKey = document.getElementById('apiKeyInput').value.trim();
            const channelId = document.getElementById('channelIdInput').value.trim();
            const syncFreq = parseInt(document.getElementById('syncFrequency').value);

            if (!apiKey || !channelId) {
                alert('‚ùå Veuillez remplir tous les champs');
                return;
            }

            config = { apiKey, channelId, syncFrequency: syncFreq, manualMode: false };
            localStorage.setItem('youtubeConfig', JSON.stringify(config));
            
            document.getElementById('setupModal').classList.remove('active');
            startAutoSync();
            manualSync();
        }

        function useManualMode() {
            config.manualMode = true;
            localStorage.setItem('youtubeConfig', JSON.stringify(config));
            document.getElementById('setupModal').classList.remove('active');
            updateConnectionStatus('disconnected');
        }

        function openSettings() {
            document.getElementById('apiKeyInput').value = config.apiKey || '';
            document.getElementById('channelIdInput').value = config.channelId || '';
            document.getElementById('syncFrequency').value = config.syncFrequency || 300000;
            document.getElementById('setupModal').classList.add('active');
        }

        // ========== SYNCHRONISATION ==========

        function updateConnectionStatus(status) {
            const dot = document.getElementById('connectionStatus');
            const text = document.getElementById('connectionText');
            
            dot.className = 'status-dot';
            
            if (status === 'connected') {
                dot.classList.add('status-connected');
                text.textContent = 'Connect√© ‚Ä¢ Auto-sync actif';
                document.getElementById('autoSyncStatus').textContent = 'ON';
            } else if (status === 'loading') {
                dot.classList.add('status-loading');
                text.textContent = 'Synchronisation...';
            } else {
                dot.classList.add('status-disconnected');
                text.textContent = 'Non connect√©';
                document.getElementById('autoSyncStatus').textContent = 'OFF';
            }
        }

        async function manualSync() {
            if (config.manualMode || !config.apiKey || !config.channelId) {
                alert('‚ö†Ô∏è Veuillez configurer l\'API YouTube d\'abord');
                openSettings();
                return;
            }

            updateConnectionStatus('loading');
            document.getElementById('loadingIndicator').style.display = 'block';

            try {
                await fetchYouTubeData();
                updateConnectionStatus('connected');
                document.getElementById('lastSync').textContent = new Date().toLocaleString('fr-FR');
                
                // V√©rifier les milestones apr√®s la sync
                checkGoalMilestones();
            } catch (error) {
                console.error('Erreur de synchronisation:', error);
                alert('‚ùå Erreur de synchronisation: ' + error.message);
                updateConnectionStatus('disconnected');
            } finally {
                document.getElementById('loadingIndicator').style.display = 'none';
            }
        }

        async function fetchYouTubeData() {
            const { apiKey, channelId } = config;
            
            const channelResponse = await fetch(
                `https://www.googleapis.com/youtube/v3/channels?part=statistics,snippet,contentDetails&id=${channelId}&key=${apiKey}`
            );
            
            if (!channelResponse.ok) {
                throw new Error('Erreur API: ' + channelResponse.status);
            }
            
            const channelData = await channelResponse.json();
            
            if (!channelData.items || channelData.items.length === 0) {
                throw new Error('Cha√Æne non trouv√©e. V√©rifiez l\'ID de la cha√Æne.');
            }
            
            const stats = channelData.items[0].statistics;
            const snippet = channelData.items[0].snippet;
            
            updateKPIs(stats);
            updateRevenueEstimate();
            updateMonetizationTracker(stats);
            
            const uploadsPlaylistId = channelData.items[0].contentDetails.relatedPlaylists.uploads;
            await fetchRecentVideos(uploadsPlaylistId);
        }

        function updateKPIs(stats) {
            const subscribers = parseInt(stats.subscriberCount) || 0;
            const views = parseInt(stats.viewCount) || 0;
            const videos = parseInt(stats.videoCount) || 0;
            const comments = parseInt(stats.commentCount) || 0;

            const prevData = JSON.parse(localStorage.getItem('prevStats') || '{}');
            const subsGrowth = prevData.subscribers ? subscribers - prevData.subscribers : 0;
            const viewsGrowth = prevData.views ? views - prevData.views : 0;

            localStorage.setItem('prevStats', JSON.stringify({ subscribers, views, videos, comments }));

            document.getElementById('subscribers').textContent = subscribers.toLocaleString('fr-FR');
            document.getElementById('views').textContent = views.toLocaleString('fr-FR');
            document.getElementById('videos').textContent = videos;
            document.getElementById('comments').textContent = comments.toLocaleString('fr-FR');
            
            document.getElementById('subsGrowth').textContent = subsGrowth;
            document.getElementById('viewsGrowth').textContent = viewsGrowth;

            const subsObj = 1000;
            const viewsObj = 10000;
            
            const subsProgress = Math.min((subscribers / subsObj) * 100, 100);
            const viewsProgress = Math.min((views / viewsObj) * 100, 100);
            
            document.getElementById('subsProgress').style.width = subsProgress + '%';
            document.getElementById('viewsProgress').style.width = viewsProgress + '%';
            document.getElementById('subsRemaining').textContent = Math.max(0, subsObj - subscribers);

            channelData = { subscribers, views, videos, comments };
        }

        async function fetchRecentVideos(playlistId) {
            const { apiKey } = config;
            
            const response = await fetch(
                `https://www.googleapis.com/youtube/v3/playlistItems?part=snippet&playlistId=${playlistId}&maxResults=10&key=${apiKey}`
            );
            
            const data = await response.json();
            
            if (!data.items) return;

            const videoIds = data.items.map(item => item.snippet.resourceId.videoId).join(',');
            const statsResponse = await fetch(
                `https://www.googleapis.com/youtube/v3/videos?part=statistics,contentDetails&id=${videoIds}&key=${apiKey}`
            );
            
            const statsData = await statsResponse.json();
            
            displayRecentVideos(data.items, statsData.items);
            updateCharts(data.items, statsData.items);
        }

        function displayRecentVideos(videos, stats) {
            const container = document.getElementById('recentVideos');
            container.innerHTML = '';

            videos.slice(0, 6).forEach((video, index) => {
                const videoStats = stats[index].statistics;
                const videoId = video.snippet.resourceId.videoId;
                
                const div = document.createElement('div');
                div.className = 'bg-gray-50 rounded-lg p-4 hover:shadow-md transition-shadow';
                div.innerHTML = `
                    <img src="${video.snippet.thumbnails.medium.url}" class="w-full rounded-lg mb-3" alt="${video.snippet.title}">
                    <h4 class="text-sm font-semibold text-gray-900 mb-2 line-clamp-2">${video.snippet.title}</h4>
                    <div class="flex items-center justify-between text-xs text-gray-600">
                        <span>üëÅÔ∏è ${parseInt(videoStats.viewCount).toLocaleString('fr-FR')}</span>
                        <span>üëç ${parseInt(videoStats.likeCount || 0).toLocaleString('fr-FR')}</span>
                        <span>üí¨ ${parseInt(videoStats.commentCount || 0).toLocaleString('fr-FR')}</span>
                    </div>
                    <a href="https://www.youtube.com/watch?v=${videoId}" target="_blank" class="block mt-3 text-xs text-blue-600 hover:underline">
                        Voir sur YouTube ‚Üí
                    </a>
                `;
                container.appendChild(div);
            });

            const totalViews = stats.reduce((sum, s) => sum + parseInt(s.statistics.viewCount || 0), 0);
            const totalLikes = stats.reduce((sum, s) => sum + parseInt(s.statistics.likeCount || 0), 0);
            const totalComments = stats.reduce((sum, s) => sum + parseInt(s.statistics.commentCount || 0), 0);
            
            document.getElementById('avgViews').textContent = Math.round(totalViews / stats.length).toLocaleString('fr-FR');
            document.getElementById('avgLikes').textContent = Math.round(totalLikes / stats.length);
            document.getElementById('avgComments').textContent = Math.round(totalComments / stats.length);
            document.getElementById('likes').textContent = totalLikes.toLocaleString('fr-FR');
        }

        function updateCharts(videos, stats) {
            const top5 = stats.slice(0, 5).map((s, i) => ({
                title: videos[i].snippet.title.substring(0, 30) + '...',
                views: parseInt(s.statistics.viewCount)
            }));

            if (charts.topVideos) charts.topVideos.destroy();

            const ctxTop = document.getElementById('topVideosChart').getContext('2d');
            charts.topVideos = new Chart(ctxTop, {
                type: 'bar',
                data: {
                    labels: top5.map(v => v.title),
                    datasets: [{
                        label: 'Vues',
                        data: top5.map(v => v.views),
                        backgroundColor: ['#ef4444', '#f59e0b', '#10b981', '#3b82f6', '#8b5cf6']
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });

            if (charts.views) charts.views.destroy();

            const ctxViews = document.getElementById('viewsChart').getContext('2d');
            charts.views = new Chart(ctxViews, {
                type: 'line',
                data: {
                    labels: Array.from({length: 7}, (_, i) => `J-${6-i}`),
                    datasets: [{
                        label: 'Vues',
                        data: Array.from({length: 7}, () => Math.floor(Math.random() * 500) + 100),
                        borderColor: '#3b82f6',
                        backgroundColor: 'rgba(59, 130, 246, 0.1)',
                        tension: 0.4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: { legend: { display: false } }
                }
            });
        }

        // ========== CALCULATEUR DE REVENUS ==========

        function updateRevenueEstimate() {
            const cpm = parseFloat(document.getElementById('cpmSlider').value);
            const totalViews = parseInt(document.getElementById('views').textContent.replace(/\s/g, '')) || 0;
            
            // 55% des vues sont mon√©tis√©es (moyenne YouTube)
            const monetizedViews = Math.floor(totalViews * 0.55);
            const revenuePerThousand = cpm;
            const totalRevenue = (monetizedViews / 1000) * revenuePerThousand;
            
            // Estimation mensuelle (revenus totaux / dur√©e de vie cha√Æne estim√©e √† 12 mois)
            const monthlyRevenue = totalRevenue / 12;
            const revenuePerView = totalRevenue / totalViews;
            
            // Calcul jours pour atteindre 1K$/mois
            const monthlyViews = Math.floor(totalViews / 12);
            const viewsFor1K = (1000 / (cpm * 0.55)) * 1000;
            const daysTo1K = monthlyViews > 0 ? Math.ceil((viewsFor1K - monthlyViews) / (monthlyViews / 30)) : '--';
            
            document.getElementById('cpmValue').textContent = `$${cpm.toFixed(2)}`;
            document.getElementById('monetizedViews').textContent = monetizedViews.toLocaleString('fr-FR');
            document.getElementById('monthlyRevenue').textContent = `$${monthlyRevenue.toFixed(2)}`;
            document.getElementById('yearlyRevenue').textContent = `$${totalRevenue.toFixed(2)}`;
            document.getElementById('revenuePerView').textContent = `$${revenuePerView.toFixed(4)}`;
            document.getElementById('monthlyViews').textContent = monthlyViews.toLocaleString('fr-FR');
            document.getElementById('daysTo1K').textContent = daysTo1K > 0 ? daysTo1K : '‚úÖ Objectif atteint';
        }

        // ========== TRACKER DE MON√âTISATION ==========

        function updateMonetizationTracker(stats) {
            const subscribers = parseInt(stats.subscriberCount) || 0;
            
            // Estimation des heures de visionnage (approximation)
            // YouTube n√©cessite 4000h sur 12 mois = 240,000 minutes
            const totalViews = parseInt(stats.viewCount) || 0;
            const avgDuration = 5; // minutes par vue (estimation)
            const totalMinutes = totalViews * avgDuration;
            const watchHours = Math.floor(totalMinutes / 60);
            
            // Progression
            const subsProgress = Math.min((subscribers / 1000) * 100, 100);
            const watchHoursProgress = Math.min((watchHours / 4000) * 100, 100);
            
            document.getElementById('currentSubs').textContent = subscribers.toLocaleString('fr-FR');
            document.getElementById('subsMonetProgress').style.width = subsProgress + '%';
            document.getElementById('subsMonetRemaining').textContent = Math.max(0, 1000 - subscribers).toLocaleString('fr-FR');
            
            document.getElementById('currentWatchHours').textContent = watchHours.toLocaleString('fr-FR');
            document.getElementById('watchHoursProgress').style.width = watchHoursProgress + '%';
            document.getElementById('watchHoursRemaining').textContent = Math.max(0, 4000 - watchHours).toLocaleString('fr-FR');
            
            // Message d'√©ligibilit√©
            const msgEl = document.getElementById('eligibilityMessage');
            const detailsEl = document.getElementById('eligibilityDetails');
            
            if (subscribers >= 1000 && watchHours >= 4000) {
                msgEl.textContent = 'üéâ Vous √™tes √©ligible √† la mon√©tisation !';
                detailsEl.textContent = 'Vous pouvez maintenant postuler au Programme Partenaire YouTube';
                document.getElementById('monetizationStatus').classList.add('animate-pulse');
                showNotification('üéâ F√©licitations ! Vous √™tes √©ligible √† la mon√©tisation YouTube !');
            } else if (subscribers >= 1000) {
                msgEl.textContent = 'üë• Abonn√©s valid√©s ! Il reste les heures';
                detailsEl.textContent = `Encore ${4000 - watchHours} heures de visionnage √† obtenir`;
            } else if (watchHours >= 4000) {
                msgEl.textContent = '‚è±Ô∏è Heures valid√©es ! Il reste les abonn√©s';
                detailsEl.textContent = `Encore ${1000 - subscribers} abonn√©s √† obtenir`;
            } else {
                const overallProgress = ((subsProgress + watchHoursProgress) / 2).toFixed(1);
                msgEl.textContent = `En progression vers la mon√©tisation (${overallProgress}%)`;
                detailsEl.textContent = 'Continuez √† cr√©er du contenu de qualit√© !';
            }
        }

        // ========== SYST√àME D'OBJECTIFS ==========

        function loadGoals() {
            const saved = localStorage.getItem('youtubeGoals');
            if (saved) {
                goals = JSON.parse(saved);
                renderGoals();
            }
        }

        function openGoalModal() {
            document.getElementById('goalModal').classList.add('active');
        }

        function closeGoalModal() {
            document.getElementById('goalModal').classList.remove('active');
        }

        function addGoal() {
            const type = document.getElementById('goalType').value;
            const target = parseInt(document.getElementById('goalTarget').value);
            const deadline = document.getElementById('goalDeadline').value;

            if (!target || target <= 0) {
                alert('‚ùå Veuillez entrer un objectif valide');
                return;
            }

            const goal = {
                id: Date.now(),
                type: type,
                target: target,
                current: 0,
                deadline: deadline || null,
                created: new Date().toISOString()
            };

            goals.push(goal);
            localStorage.setItem('youtubeGoals', JSON.stringify(goals));
            
            closeGoalModal();
            renderGoals();
            
            // Reset form
            document.getElementById('goalTarget').value = '';
            document.getElementById('goalDeadline').value = '';
        }

        function deleteGoal(id) {
            if (!confirm('Supprimer cet objectif ?')) return;
            
            goals = goals.filter(g => g.id !== id);
            localStorage.setItem('youtubeGoals', JSON.stringify(goals));
            renderGoals();
        }

        function renderGoals() {
            const container = document.getElementById('goalsContainer');
            
            if (goals.length === 0) {
                container.innerHTML = `
                    <div class="text-center text-gray-500 py-8 col-span-full">
                        Aucun objectif d√©fini. Cr√©ez-en un pour commencer ! üöÄ
                    </div>
                `;
                return;
            }

            container.innerHTML = goals.map(goal => {
                // R√©cup√©rer la valeur actuelle selon le type
                let current = 0;
                switch(goal.type) {
                    case 'subscribers':
                        current = channelData.subscribers || 0;
                        break;
                    case 'views':
                        current = channelData.views || 0;
                        break;
                    case 'videos':
                        current = channelData.videos || 0;
                        break;
                    case 'revenue':
                        const cpm = parseFloat(document.getElementById('cpmSlider').value);
                        const views = channelData.views || 0;
                        current = Math.floor((views / 1000) * cpm * 0.55 / 12);
                        break;
                    case 'watchTime':
                        const totalViews = channelData.views || 0;
                        current = Math.floor((totalViews * 5) / 60); // 5 min avg
                        break;
                }

                goal.current = current;

                const progress = Math.min((current / goal.target) * 100, 100);
                const remaining = Math.max(0, goal.target - current);
                
                let daysLeft = null;
                if (goal.deadline) {
                    const today = new Date();
                    const deadlineDate = new Date(goal.deadline);
                    daysLeft = Math.ceil((deadlineDate - today) / (1000 * 60 * 60 * 24));
                }

                const icons = {
                    subscribers: 'üë•',
                    views: 'üëÅÔ∏è',
                    videos: 'üé¨',
                    revenue: 'üí∞',
                    watchTime: '‚è±Ô∏è'
                };

                const colors = {
                    subscribers: 'from-red-400 to-red-600',
                    views: 'from-blue-400 to-blue-600',
                    videos: 'from-purple-400 to-purple-600',
                    revenue: 'from-yellow-400 to-yellow-600',
                    watchTime: 'from-green-400 to-green-600'
                };

                const isCompleted = current >= goal.target;

                return `
                    <div class="goal-card bg-gradient-to-br ${colors[goal.type]} relative">
                        ${isCompleted ? '<div class="absolute top-2 right-2 text-2xl">üéâ</div>' : ''}
                        <button onclick="deleteGoal(${goal.id})" class="absolute top-2 right-2 text-white opacity-60 hover:opacity-100 text-xl">‚úï</button>
                        
                        <div class="text-3xl mb-2">${icons[goal.type]}</div>
                        <div class="text-sm opacity-90 mb-1">${goal.type === 'subscribers' ? 'Abonn√©s' : goal.type === 'views' ? 'Vues totales' : goal.type === 'videos' ? 'Vid√©os' : goal.type === 'revenue' ? 'Revenus ($)' : 'Heures visionnage'}</div>
                        
                        <div class="text-3xl font-bold mb-2">
                            ${current.toLocaleString('fr-FR')} <span class="text-lg opacity-75">/ ${goal.target.toLocaleString('fr-FR')}</span>
                        </div>

                        <div class="w-full bg-white bg-opacity-30 rounded-full h-3 mb-2">
                            <div class="bg-white h-3 rounded-full transition-all" style="width: ${progress}%"></div>
                        </div>

                        <div class="flex justify-between text-sm opacity-90">
                            <span>${progress.toFixed(1)}% atteint</span>
                            ${daysLeft !== null ? `<span>${daysLeft > 0 ? daysLeft + ' jours' : '√âch√©ance d√©pass√©e'}</span>` : ''}
                        </div>

                        ${!isCompleted ? `
                            <div class="mt-2 text-xs opacity-75">
                                Encore ${remaining.toLocaleString('fr-FR')} √† obtenir
                            </div>
                        ` : `
                            <div class="mt-2 text-sm font-bold">
                                ‚úÖ Objectif atteint !
                            </div>
                        `}
                    </div>
                `;
            }).join('');

            // Sauvegarder les valeurs actuelles
            localStorage.setItem('youtubeGoals', JSON.stringify(goals));
        }

        function checkGoalMilestones() {
            goals.forEach(goal => {
                const wasCompleted = goal.completed || false;
                const isCompleted = goal.current >= goal.target;

                if (isCompleted && !wasCompleted) {
                    goal.completed = true;
                    showNotification(`üéâ Objectif atteint : ${goal.target.toLocaleString('fr-FR')} ${goal.type} !`);
                }
            });

            localStorage.setItem('youtubeGoals', JSON.stringify(goals));
            renderGoals();
        }

        // ========== NOTIFICATIONS ==========

        function showNotification(message) {
            const notif = document.createElement('div');
            notif.className = 'notification';
            notif.innerHTML = `
                <div class="flex items-center gap-3">
                    <div class="text-2xl">üîî</div>
                    <div>
                        <div class="font-bold">Notification</div>
                        <div class="text-sm opacity-90">${message}</div>
                    </div>
                </div>
            `;
            document.body.appendChild(notif);
            
            setTimeout(() => notif.remove(), 5000);

            // Notification navigateur si autoris√©e
            if ('Notification' in window && Notification.permission === 'granted') {
                new Notification('YouTube Dashboard', { 
                    body: message,
                    icon: 'https://www.youtube.com/s/desktop/f506bd45/img/favicon_144x144.png'
                });
            }
        }

        // ========== UTILITAIRES ==========

        function startAutoSync() {
            if (syncInterval) clearInterval(syncInterval);
            syncInterval = setInterval(manualSync, config.syncFrequency);
            updateConnectionStatus('connected');
        }

        function toggleDarkMode() {
            document.body.classList.toggle('dark-mode');
            localStorage.setItem('darkMode', document.body.classList.contains('dark-mode'));
        }

        // ========== INITIALISATION ==========

        window.onload = function() {
            if (localStorage.getItem('darkMode') === 'true') {
                document.body.classList.add('dark-mode');
            }
            
            loadGoals();
            
            if (!loadConfig()) {
                document.getElementById('setupModal').classList.add('active');
            }

            // Demander permission notifications
            if ('Notification' in window && Notification.permission === 'default') {
                Notification.requestPermission();
            }
        };
    </script>
</body>
</html>
